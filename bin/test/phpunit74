#!/usr/bin/env sh

set -eu

if [ $(which docker || false) ]; then
    readonly rootDirectory=$(realpath $(dirname $(realpath $0))/../..)
    readonly phpunitParameters="$@"

    docker \
        run \
        -it \
        --rm \
        -v ${rootDirectory}:/app:ro \
        --entrypoint /app/bin/test/phpunit74 \
        --env PHPUNIT_PARAMETERS="${phpunitParameters}" \
        phpobject/core:phpunit-php74
else
    phpunit ${PHPUNIT_PARAMETERS}
fi
